<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¢ãƒ³ã‚¹ãƒˆã‚¹ãƒ©ã‚¤ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&family=Bebas+Neue&display=swap" rel="stylesheet">
    <style>
        :root{--fire:#E53935;--fire-dark:#B71C1C;--water:#1E88E5;--water-dark:#0D47A1;--wood:#43A047;--wood-dark:#1B5E20;--light:#FDD835;--light-dark:#F9A825;--dark:#8E24AA;--dark-dark:#4A148C;--bg-primary:#0a0a0f;--bg-secondary:#12121a;--bg-card:#1a1a25;--text-primary:#fff;--text-secondary:#a0a0b0;--border-color:#2a2a3a}
        [data-theme="light"]{--bg-primary:#f5f5f7;--bg-secondary:#ffffff;--bg-card:#e8e8ed;--text-primary:#1a1a2e;--text-secondary:#5a5a6e;--border-color:#d0d0d8}
        *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Noto Sans JP',sans-serif;background:var(--bg-primary);color:var(--text-primary);min-height:100vh;transition:background .3s,color .3s}.app-container{display:flex;flex-direction:column;min-height:100vh}
        header{background:linear-gradient(135deg,var(--bg-secondary),var(--bg-primary));padding:1rem 2rem;border-bottom:1px solid var(--border-color);display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:1rem}
        .logo{display:flex;align-items:center;gap:.75rem}.logo-icon{width:40px;height:40px;background:linear-gradient(135deg,var(--fire),var(--dark));border-radius:10px;display:flex;align-items:center;justify-content:center;font-family:'Bebas Neue',sans-serif;font-size:1.5rem}.logo h1{font-size:1.25rem;font-weight:700;background:linear-gradient(90deg,#fff,#a0a0ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .nav-tabs{display:flex;gap:.5rem}.nav-tab{padding:.5rem 1rem;background:transparent;border:1px solid var(--border-color);border-radius:8px;color:var(--text-secondary);cursor:pointer;transition:all .2s;font-family:inherit;font-size:.875rem}.nav-tab:hover{border-color:var(--text-secondary)}.nav-tab.active{background:var(--bg-card);border-color:var(--fire);color:var(--text-primary)}
        main{flex:1;display:flex;gap:1.5rem;padding:1.5rem;overflow:hidden}@media(max-width:1200px){main{flex-direction:column;overflow:auto}}
        .editor-panel{flex:0 0 420px;background:var(--bg-secondary);border-radius:16px;border:1px solid var(--border-color);overflow-y:auto;max-height:calc(100vh - 120px)}@media(max-width:1200px){.editor-panel{flex:none;max-height:none}}
        .editor-section{padding:1.25rem;border-bottom:1px solid var(--border-color)}.editor-section:last-child{border-bottom:none}.section-title{font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:var(--text-secondary);margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}.section-title::before{content:'';width:3px;height:12px;background:var(--fire);border-radius:2px}
        .form-row{display:flex;gap:.75rem;margin-bottom:.75rem}.form-group{flex:1;display:flex;flex-direction:column;gap:.375rem}label{font-size:.75rem;color:var(--text-secondary);font-weight:500}input,select{padding:.625rem .875rem;background:var(--bg-card);border:1px solid var(--border-color);border-radius:8px;color:var(--text-primary);font-family:inherit;font-size:.875rem;transition:border-color .2s}input:focus,select:focus{outline:none;border-color:var(--fire)}select{cursor:pointer}
        .checkbox-label{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-size:.875rem;color:var(--text-secondary);padding:.25rem 0;white-space:nowrap}.checkbox-label input[type="checkbox"]{width:1.1rem;height:1.1rem;cursor:pointer;accent-color:var(--fire)}
        .ability-input-group{display:flex;flex-direction:column;gap:.5rem}.ability-row{display:flex;gap:.5rem;align-items:center}.ability-row input{flex:1}.ability-type-badge{font-size:.625rem;padding:.25rem .5rem;border-radius:4px;font-weight:700;min-width:50px;text-align:center}.ability-toggle{font-size:.625rem;padding:.25rem .5rem;border-radius:4px;font-weight:700;min-width:50px;text-align:center;cursor:pointer;border:none;transition:all .2s}.ability-toggle:hover{opacity:.8;transform:scale(1.05)}.badge-ability{background:#2d2d4a;color:#a0a0ff}.badge-gauge{background:#4a2d4a;color:#ffa0ff}.badge-connect{background:#2d4a4a;color:#a0ffff}
        .image-upload-area{border:2px dashed var(--border-color);border-radius:12px;padding:1.5rem;text-align:center;cursor:pointer;transition:all .2s;position:relative;overflow:hidden}.image-upload-area:hover{border-color:var(--fire);background:rgba(229,57,53,.05)}.image-upload-area.has-image{padding:0;border-style:solid}.image-upload-area img{width:100%;height:200px;object-fit:contain;display:block}.upload-placeholder{color:var(--text-secondary);font-size:.875rem}.upload-placeholder svg{width:48px;height:48px;margin-bottom:.5rem;opacity:.5}#imageInput{display:none}
        .image-controls{margin-top:1rem;padding:1rem;background:var(--bg-card);border-radius:12px}.image-controls .form-row{align-items:center;margin-bottom:.5rem}.image-controls input[type="range"]{flex:1;margin-right:.5rem;accent-color:var(--fire)}.image-controls span{min-width:50px;text-align:right;font-size:.75rem;color:var(--text-secondary)}
        .preview-panel{flex:1;display:flex;flex-direction:column;gap:1rem;min-width:0}.preview-header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem}.preview-title{font-size:1rem;font-weight:600;color:var(--text-secondary)}.action-buttons{display:flex;gap:.5rem}
        .btn{padding:.625rem 1.25rem;border-radius:8px;font-family:inherit;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:.5rem;border:none}.btn-primary{background:linear-gradient(135deg,var(--fire),var(--fire-dark));color:#fff}.btn-primary:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(229,57,53,.4)}.btn-secondary{background:var(--bg-card);color:var(--text-primary);border:1px solid var(--border-color)}.btn-secondary:hover{border-color:var(--text-secondary)}
        .theme-toggle{padding:.5rem;min-width:auto}
        .preview-container{flex:1;display:flex;align-items:flex-start;justify-content:center;background:var(--bg-secondary);border-radius:16px;border:1px solid var(--border-color);padding:1rem;overflow:auto;min-height:0}.preview-wrapper{width:960px;flex-shrink:0;transform-origin:top center}
        .slide{width:1920px;height:1080px;position:relative;overflow:hidden;font-family:'Noto Sans JP',sans-serif;transform-origin:top left}.slide-bg{position:absolute;inset:0;background:linear-gradient(135deg,#0a0a12,#1a1a2e 50%,#0a0a12)}.slide-bg::before{content:'';position:absolute;inset:0;background:radial-gradient(circle at 20% 80%,var(--accent-color,var(--fire)) 0%,transparent 50%),radial-gradient(circle at 80% 20%,var(--accent-color,var(--fire)) 0%,transparent 50%);opacity:.15}
        .slide.light-mode .slide-bg{background:linear-gradient(135deg,#f8f8fc,#e8e8f0 50%,#f8f8fc)}.slide.light-mode .slide-bg::before{opacity:.1}
        .slide.light-mode .info-card{background:rgba(0,0,0,.05);border-color:rgba(0,0,0,.1)}.slide.light-mode .info-label{color:rgba(0,0,0,.5)}.slide.light-mode .info-value{color:#1a1a2e}
        .slide.light-mode .abilities-title{color:rgba(0,0,0,.7)}.slide.light-mode .ability-tag{color:#fff}
        .slide.light-mode .skill-card,.slide.light-mode .friendship-card{background:rgba(0,0,0,.05);border-color:rgba(0,0,0,.1)}.slide.light-mode .skill-name,.slide.light-mode .friendship-name{color:#1a1a2e}.slide.light-mode .skill-effect{color:rgba(0,0,0,.7)}.slide.light-mode .skill-turn,.slide.light-mode .friendship-label{color:rgba(0,0,0,.5)}
        .slide.light-mode .special-skill-card{background:rgba(0,0,0,.08)}.slide.light-mode .special-skill-name{color:#1a1a2e}
        .slide.light-mode .no-image-placeholder{background:rgba(0,0,0,.05);border-color:rgba(0,0,0,.2);color:rgba(0,0,0,.3)}
        .slide-content{position:relative;z-index:1;height:100%;display:grid;grid-template-columns:1fr 1fr;gap:40px;padding:40px 60px}.slide-left{display:flex;flex-direction:column;gap:24px}
        .evolution-badge{display:inline-flex;align-items:center;gap:12px;padding:14px 32px;background:linear-gradient(135deg,var(--accent-color,var(--fire)),var(--accent-dark,var(--fire-dark)));border-radius:50px;font-size:36px;font-weight:900;letter-spacing:.05em;box-shadow:0 8px 32px rgba(0,0,0,.4);width:fit-content;color:#fff}.evolution-badge::before{content:'â˜…';font-size:28px}
        .basic-info-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}.info-card{background:rgba(255,255,255,.05);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:16px 20px;display:flex;flex-direction:column;gap:6px}.info-label{font-size:18px;color:rgba(255,255,255,.5);font-weight:500}.info-value{font-size:36px;font-weight:900;color:#fff}.info-value.shot-reflect{color:#ff6b6b}.info-value.shot-penetrate{color:#4dabf7}
        .slide.light-mode .info-value.shot-reflect{color:#e53935}.slide.light-mode .info-value.shot-penetrate{color:#1565c0}
        .char-name-display{position:absolute;top:40px;right:60px;z-index:10;text-align:right}.char-name-text{font-size:48px;font-weight:900;color:#fff;text-shadow:0 4px 20px rgba(0,0,0,.8)}.slide.light-mode .char-name-text{color:#1a1a2e;text-shadow:0 4px 20px rgba(255,255,255,.8)}
        .abilities-section{flex:0 0 auto;display:flex;flex-direction:column;gap:12px}.abilities-title{font-size:26px;font-weight:700;color:rgba(255,255,255,.7);display:flex;align-items:center;gap:12px}.abilities-title::before{content:'';width:5px;height:26px;background:var(--accent-color,var(--fire));border-radius:2px}.abilities-list{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
        .ability-tag{padding:12px 20px;border-radius:10px;font-size:28px;font-weight:700;display:flex;align-items:center;gap:10px}.ability-tag.type-ability{background:linear-gradient(135deg,#3d3d6a,#2d2d4a);border:1px solid #5d5d8a}.ability-tag.type-gauge{background:linear-gradient(135deg,#6a3d6a,#4a2d4a);border:1px solid #8a5d8a}.ability-tag.type-gauge::before{content:'G';font-size:18px;padding:4px 8px;background:rgba(255,255,255,.2);border-radius:4px}.ability-tag.type-connect{background:linear-gradient(135deg,#3d6a6a,#2d4a4a);border:1px solid #5d8a8a}.ability-tag.type-connect::before{content:'C';font-size:18px;padding:4px 8px;background:rgba(255,255,255,.2);border-radius:4px}
        .slide-right{display:flex;flex-direction:column;gap:20px;height:100%}.character-image-container{height:500px;flex:0 0 500px;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}.character-image-wrapper{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;overflow:hidden}.character-image-wrapper::before{content:'';position:absolute;width:400px;height:400px;background:radial-gradient(circle,var(--accent-color,var(--fire)) 0%,transparent 70%);opacity:.3;border-radius:50%}.character-image{max-width:100%;max-height:100%;object-fit:contain;position:relative;z-index:1;filter:drop-shadow(0 20px 40px rgba(0,0,0,.5))}.no-image-placeholder{width:300px;height:300px;background:rgba(255,255,255,.05);border:2px dashed rgba(255,255,255,.2);border-radius:24px;display:flex;align-items:center;justify-content:center;color:rgba(255,255,255,.3);font-size:20px}
        .skills-section{display:flex;flex-direction:column;gap:12px;flex:0 0 auto}.skill-card{background:rgba(255,255,255,.05);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.1);border-radius:16px;padding:18px 24px}.skill-header{display:flex;align-items:center;gap:14px;margin-bottom:10px}.skill-type{font-size:20px;font-weight:700;color:var(--accent-color,var(--fire));padding:6px 16px;background:rgba(255,255,255,.1);border-radius:8px}.skill-turn{font-size:32px;font-weight:700;color:rgba(255,255,255,.8);margin-left:auto}.skill-name{font-size:32px;font-weight:900;line-height:1.3}.skill-effect{font-size:28px;color:rgba(255,255,255,.8);margin-top:8px;line-height:1.4;font-weight:700}
        .friendship-section{display:grid;grid-template-columns:1fr 1fr;gap:12px}.friendship-card{background:rgba(255,255,255,.05);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:16px 20px}.friendship-label{font-size:18px;color:rgba(255,255,255,.5);margin-bottom:8px}.friendship-name{font-size:28px;font-weight:700}
        .hidden{display:none!important}.history-panel{display:none;flex:1;background:var(--bg-secondary);border-radius:16px;border:1px solid var(--border-color);overflow:hidden}.history-panel.active{display:flex;flex-direction:column}.history-header{padding:1.25rem;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center}.history-title{font-size:1rem;font-weight:600}.history-list{flex:1;overflow-y:auto;padding:1rem;display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem;align-content:start}.history-item{background:var(--bg-card);border:1px solid var(--border-color);border-radius:12px;overflow:hidden;cursor:pointer;transition:all .2s}.history-item:hover{border-color:var(--fire);transform:translateY(-2px)}.history-thumbnail{width:100%;aspect-ratio:16/9;object-fit:cover;background:var(--bg-primary)}.history-info{padding:.75rem}.history-name{font-size:.875rem;font-weight:600;margin-bottom:.25rem}.history-meta{font-size:.75rem;color:var(--text-secondary);display:flex;justify-content:space-between}.history-actions{display:flex;gap:.5rem;padding:0 .75rem .75rem}.history-btn{flex:1;padding:.5rem;border-radius:6px;font-size:.75rem;font-weight:600;cursor:pointer;border:none;font-family:inherit;transition:all .2s}.history-btn-edit{background:var(--bg-secondary);color:var(--text-primary);border:1px solid var(--border-color)}.history-btn-delete{background:rgba(229,57,53,.1);color:var(--fire)}.empty-history{text-align:center;color:var(--text-secondary);padding:3rem;grid-column:1/-1}
        .help-panel{display:none;flex:1;background:var(--bg-secondary);border-radius:16px;border:1px solid var(--border-color);overflow:hidden}.help-panel.active{display:flex;flex-direction:column}.help-content{flex:1;overflow-y:auto;padding:2rem;line-height:1.8}.help-content h2{font-size:1.5rem;margin:1.5rem 0 1rem;color:var(--fire)}.help-content h2:first-child{margin-top:0}.help-content h3{font-size:1.1rem;margin:1.25rem 0 .75rem;color:var(--text-primary)}.help-content h4{font-size:1rem;margin:1rem 0 .5rem;color:var(--text-secondary)}.help-content ul{margin:.5rem 0;padding-left:1.5rem}.help-content li{margin:.4rem 0}.help-content p{margin:.75rem 0}.help-author{margin-top:2rem;padding-top:1rem;border-top:1px solid var(--border-color);color:var(--text-secondary);font-size:.9rem}
        @media(min-width:1201px){.slide{transform:scale(.5)}.preview-wrapper{height:540px}}@media(max-width:1200px){.slide{transform:scale(.5)}.preview-wrapper{height:540px}}@media(max-width:900px){.slide{transform:scale(.4)}.preview-wrapper{height:432px}}@media(max-width:768px){header{padding:1rem}main{padding:1rem}.slide{transform:scale(.3)}.preview-wrapper{height:324px}.editor-panel{flex:none}}
        .loading-overlay{position:fixed;inset:0;background:rgba(10,10,15,.9);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;pointer-events:none;transition:opacity .3s}.loading-overlay.active{opacity:1;pointer-events:all}.loading-spinner{width:48px;height:48px;border:3px solid var(--border-color);border-top-color:var(--fire);border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}
        .form-skills-special{background:rgba(229,57,53,.05);border:1px solid rgba(229,57,53,.2);border-radius:12px;padding:1rem;margin-top:.5rem}.special-skills-label{font-size:.75rem;color:var(--fire);font-weight:600;margin-bottom:.75rem;display:flex;align-items:center;gap:.5rem}.special-skill-card{background:rgba(0,0,0,.2);border-radius:12px;padding:16px 20px;margin-bottom:12px}.special-skill-card:last-child{margin-bottom:0}.special-skill-type{font-size:18px;font-weight:700;color:var(--accent-color,var(--fire));margin-bottom:8px}.special-skill-name{font-size:28px;font-weight:700}
        .luck-skill-card{background:linear-gradient(135deg,#2d4a2d,#1d3a1d);border:1px solid #3d6a3d;border-radius:12px;padding:14px 18px;margin-top:12px}.luck-skill-label{font-size:16px;color:rgba(255,255,255,.6);margin-bottom:6px}.luck-skill-name{font-size:24px;font-weight:700;color:#4ade80}
        .connect-condition-card{background:linear-gradient(135deg,#2d4a4a,#1d3a3a);border:1px solid #3d6a6a;border-radius:12px;padding:14px 18px;margin-top:12px}.connect-condition-label{font-size:16px;color:rgba(255,255,255,.6);margin-bottom:6px}.connect-condition-text{font-size:22px;font-weight:700;color:#a0ffff}
        .slide.light-mode .luck-skill-card{background:linear-gradient(135deg,#c0f0c0,#b0e8b0);border-color:#80c080}.slide.light-mode .luck-skill-label{color:rgba(0,0,0,.5)}.slide.light-mode .luck-skill-name{color:#16a34a}
        .slide.light-mode .connect-condition-card{background:linear-gradient(135deg,#c0f0f0,#b0e8e8);border-color:#80c0c0}.slide.light-mode .connect-condition-label{color:rgba(0,0,0,.5)}.slide.light-mode .connect-condition-text{color:#008080}
    </style>
</head>
<body>
<div class="app-container">
    <header><div class="logo"><div class="logo-icon">M</div><h1>ãƒ¢ãƒ³ã‚¹ãƒˆã‚¹ãƒ©ã‚¤ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼</h1></div><div style="display:flex;align-items:center;gap:1rem"><nav class="nav-tabs"><button class="nav-tab active" data-tab="editor">ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼</button><button class="nav-tab" data-tab="history">ä½œæˆå±¥æ­´</button><button class="nav-tab" data-tab="help">ä½¿ã„æ–¹</button></nav><button class="btn btn-secondary theme-toggle" id="themeToggle" title="ãƒ†ãƒ¼ãƒåˆ‡æ›¿"><svg id="darkIcon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="lightIcon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></header>
    <main>
        <div class="editor-panel" id="editorPanel">
            <div class="editor-section"><h3 class="section-title">åŸºæœ¬æƒ…å ±</h3><div class="form-row"><div class="form-group"><label for="charName">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å</label><input type="text" id="charName" placeholder="ä¾‹: ãƒ«ã‚·ãƒ•ã‚¡ãƒ¼"></div><div class="form-group" style="flex:0 0 auto;align-self:flex-end"><label class="checkbox-label"><input type="checkbox" id="showCharName"><span>ç”»åƒã«è¡¨ç¤º</span></label></div></div><div class="form-row"><div class="form-group"><label for="evolution">é€²åŒ–å½¢æ…‹</label><select id="evolution"><option value="ç£ç¥åŒ–">ç£ç¥åŒ–</option><option value="ç£ç¥åŒ–æ”¹">ç£ç¥åŒ–æ”¹</option><option value="çœŸç£ç¥åŒ–">çœŸç£ç¥åŒ–</option></select></div><div class="form-group"><label for="attribute">å±æ€§</label><select id="attribute"><option value="fire">ç«å±æ€§</option><option value="water">æ°´å±æ€§</option><option value="wood">æœ¨å±æ€§</option><option value="light">å…‰å±æ€§</option><option value="dark">é—‡å±æ€§</option></select></div></div><div class="form-row"><div class="form-group"><label for="shotType">æ’ƒç¨®</label><select id="shotType"><option value="åå°„">åå°„</option><option value="åå°„&ã‚²ãƒ¼ã‚¸">åå°„&ã‚²ãƒ¼ã‚¸</option><option value="è²«é€š">è²«é€š</option><option value="è²«é€š&ã‚²ãƒ¼ã‚¸">è²«é€š&ã‚²ãƒ¼ã‚¸</option></select></div><div class="form-group"><label for="battleType">æˆ¦å‹</label><select id="battleType"><option value="ãƒãƒ©ãƒ³ã‚¹å‹">ãƒãƒ©ãƒ³ã‚¹å‹</option><option value="ãƒ‘ãƒ¯ãƒ¼å‹">ãƒ‘ãƒ¯ãƒ¼å‹</option><option value="ã‚¹ãƒ”ãƒ¼ãƒ‰å‹">ã‚¹ãƒ”ãƒ¼ãƒ‰å‹</option><option value="ç ²æ’ƒå‹">ç ²æ’ƒå‹</option></select></div></div><div class="form-row"><div class="form-group"><label for="race">ç¨®æ—</label><input type="text" id="race" placeholder="ä¾‹: é­”æ—"></div></div></div>
            <div class="editor-section"><h3 class="section-title">ã‚¢ãƒ“ãƒªãƒ†ã‚£</h3><div class="ability-input-group"><div class="ability-row"><button type="button" class="ability-toggle badge-ability" data-idx="0" onclick="toggleAb(0)">ã‚¢ãƒ“</button><input type="text" id="ab0" placeholder="ã‚¢ãƒ“ãƒªãƒ†ã‚£1"></div><div class="ability-row"><button type="button" class="ability-toggle badge-ability" data-idx="1" onclick="toggleAb(1)">ã‚¢ãƒ“</button><input type="text" id="ab1" placeholder="ã‚¢ãƒ“ãƒªãƒ†ã‚£2"></div><div class="ability-row"><button type="button" class="ability-toggle badge-ability" data-idx="2" onclick="toggleAb(2)">ã‚¢ãƒ“</button><input type="text" id="ab2" placeholder="ã‚¢ãƒ“ãƒªãƒ†ã‚£3"></div><div class="ability-row"><button type="button" class="ability-toggle badge-ability" data-idx="3" onclick="toggleAb(3)">ã‚¢ãƒ“</button><input type="text" id="ab3" placeholder="ã‚¢ãƒ“ãƒªãƒ†ã‚£4"></div><div class="ability-row"><button type="button" class="ability-toggle badge-ability" data-idx="4" onclick="toggleAb(4)">ã‚¢ãƒ“</button><input type="text" id="ab4" placeholder="ã‚¢ãƒ“ãƒªãƒ†ã‚£5"></div><div class="ability-row"><button type="button" class="ability-toggle badge-ability" data-idx="5" onclick="toggleAb(5)">ã‚¢ãƒ“</button><input type="text" id="ab5" placeholder="ã‚¢ãƒ“ãƒªãƒ†ã‚£6"></div><div class="ability-row"><button type="button" class="ability-toggle badge-ability" data-idx="6" onclick="toggleAb(6)">ã‚¢ãƒ“</button><input type="text" id="ab6" placeholder="ã‚¢ãƒ“ãƒªãƒ†ã‚£7"></div><div class="ability-row"><button type="button" class="ability-toggle badge-ability" data-idx="7" onclick="toggleAb(7)">ã‚¢ãƒ“</button><input type="text" id="ab7" placeholder="ã‚¢ãƒ“ãƒªãƒ†ã‚£8"></div></div></div>
            <div class="editor-section" id="connectSection"><h3 class="section-title">ã‚³ãƒã‚¯ãƒˆã‚¹ã‚­ãƒ«ï¼ˆç£ç¥åŒ–æ”¹ã®ã¿ï¼‰</h3><div class="ability-input-group"><div class="ability-row"><span class="ability-type-badge badge-connect">ã‚³ãƒ</span><input type="text" id="connect1" placeholder="ã‚³ãƒã‚¯ãƒˆã‚¹ã‚­ãƒ«1"></div><div class="ability-row"><span class="ability-type-badge badge-connect">ã‚³ãƒ</span><input type="text" id="connect2" placeholder="ã‚³ãƒã‚¯ãƒˆã‚¹ã‚­ãƒ«2"></div><div class="ability-row"><span class="ability-type-badge badge-connect">ã‚³ãƒ</span><input type="text" id="connect3" placeholder="ã‚³ãƒã‚¯ãƒˆã‚¹ã‚­ãƒ«3"></div></div><div class="form-group" style="margin-top:.75rem"><label for="connectCondition">ç™ºå‹•æ¡ä»¶</label><input type="text" id="connectCondition" placeholder="ä¾‹: å…‰å±æ€§ã‹ã¤äºœäººæ—ã®ã‚­ãƒ£ãƒ©ãŒ2ä½“ä»¥ä¸Š"></div></div>
            <div class="editor-section"><h3 class="section-title">ãƒ©ãƒƒã‚¯ã‚¹ã‚­ãƒ«</h3><div class="form-row"><div class="form-group"><label for="luckSkill">ãƒ©ãƒƒã‚¯ã‚¹ã‚­ãƒ«</label><select id="luckSkill"><option value="">ãªã—</option><option value="ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«">ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«</option><option value="ã‚¬ã‚¤ãƒ‰">ã‚¬ã‚¤ãƒ‰</option><option value="ã‚·ãƒ¼ãƒ«ãƒ‰">ã‚·ãƒ¼ãƒ«ãƒ‰</option><option value="å‹æƒ…ã‚³ãƒ³ãƒœã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«">å‹æƒ…ã‚³ãƒ³ãƒœã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«</option></select></div></div></div>
            <div class="editor-section" id="specialSkillsSection"><h3 class="section-title">å½¢æ…‹å›ºæœ‰ã‚¹ã‚­ãƒ«ï¼ˆçœŸç£ç¥åŒ–ã®ã¿ï¼‰</h3><div class="form-skills-special"><div class="special-skills-label"><span>â˜…</span> çœŸç£ç¥åŒ–é™å®šã‚¹ã‚­ãƒ«</div><div class="form-group"><label for="shotSkill">ã‚·ãƒ§ãƒƒãƒˆã‚¹ã‚­ãƒ«</label><input type="text" id="shotSkill" placeholder="ä¾‹: å¼±ç‚¹ãƒ’ãƒƒãƒˆã§æ”»æ’ƒåŠ›ã‚¢ãƒƒãƒ—"></div><div class="form-group" style="margin-top:.75rem"><label for="assistSkill">ã‚¢ã‚·ã‚¹ãƒˆã‚¹ã‚­ãƒ«</label><input type="text" id="assistSkill" placeholder="ä¾‹: å‘³æ–¹ã®æ”»æ’ƒåŠ›ã‚¢ãƒƒãƒ—"></div></div></div>
            <div class="editor-section"><h3 class="section-title">ã‚¹ãƒˆãƒ©ã‚¤ã‚¯ã‚·ãƒ§ãƒƒãƒˆ</h3><div class="form-row"><div class="form-group"><label for="ssName">SSåç§°</label><input type="text" id="ssName" placeholder="ä¾‹: çµ¶å¯¾é›¶åº¦ã®è£ã"></div><div class="form-group" style="flex:0 0 100px"><label for="ssTurn">ã‚¿ãƒ¼ãƒ³æ•°</label><input type="text" id="ssTurn" placeholder="ä¾‹: 16"></div></div><div class="form-row"><div class="form-group"><label for="ssEffect">SSåŠ¹æœ</label><input type="text" id="ssEffect" placeholder="ä¾‹: è‡ªå¼·åŒ–&æ•µã‚’è²«ãåˆ†èº«å¼¾ã‚’æ”¾ã¤"></div></div></div>
            <div class="editor-section"><h3 class="section-title">å‹æƒ…ã‚³ãƒ³ãƒœ</h3><div class="form-row"><div class="form-group"><label for="friendship">å‹æƒ…ã‚³ãƒ³ãƒœ</label><input type="text" id="friendship" placeholder="ä¾‹: è¶…å¼·ãƒˆãƒ©ã‚¤ãƒ‡ãƒ³ãƒˆãƒ¬ãƒ¼ã‚¶ãƒ¼EL"></div></div><div class="form-row"><div class="form-group"><label for="subFriendship">å‰¯å‹æƒ…ã‚³ãƒ³ãƒœ</label><input type="text" id="subFriendship" placeholder="ä¾‹: è¶…çµ¶é›»æ’ƒ"></div></div></div>
            <div class="editor-section"><h3 class="section-title">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”»åƒ</h3><div class="image-upload-area" id="imageUploadArea"><input type="file" id="imageInput" accept="image/*"><div class="upload-placeholder" id="uploadPlaceholder"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg><p>ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—</p></div></div><div class="image-controls" id="imageControls" style="display:none"><div class="form-row"><div class="form-group"><label>ã‚µã‚¤ã‚º</label><input type="range" id="imgScale" min="50" max="200" value="100"><span id="imgScaleVal">100%</span></div></div><div class="form-row"><div class="form-group"><label>æ¨ªä½ç½®</label><input type="range" id="imgX" min="-200" max="200" value="0"><span id="imgXVal">0</span></div></div><div class="form-row"><div class="form-group"><label>ç¸¦ä½ç½®</label><input type="range" id="imgY" min="-200" max="200" value="0"><span id="imgYVal">0</span></div></div><button type="button" class="btn btn-secondary" onclick="resetImg()" style="width:100%;margin-top:.5rem">ãƒªã‚»ãƒƒãƒˆ</button></div></div>
        </div>
        <div class="preview-panel" id="previewPanel">
            <div class="preview-header"><span class="preview-title">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</span><div class="action-buttons"><button class="btn btn-secondary" id="saveBtn"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>ä¿å­˜</button><button class="btn btn-primary" id="exportBtn"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>PNGå‡ºåŠ›</button></div></div>
            <div class="preview-container"><div class="preview-wrapper"><div class="slide" id="slide"><div class="slide-bg"></div><div class="char-name-display" id="slideCharNameArea" style="display:none"><div class="char-name-text" id="slideCharName"></div></div><div class="slide-content"><div class="slide-left"><div class="evolution-badge" id="slideEvolution">ç£ç¥åŒ–</div><div class="basic-info-grid"><div class="info-card"><span class="info-label">å±æ€§</span><span class="info-value" id="slideAttribute">ç«</span></div><div class="info-card"><span class="info-label">æ’ƒç¨®</span><span class="info-value" id="slideShotType">åå°„</span></div><div class="info-card"><span class="info-label">æˆ¦å‹</span><span class="info-value" id="slideBattleType">ãƒãƒ©ãƒ³ã‚¹å‹</span></div><div class="info-card"><span class="info-label">ç¨®æ—</span><span class="info-value" id="slideRace">é­”æ—</span></div></div><div class="abilities-section"><h4 class="abilities-title">ã‚¢ãƒ“ãƒªãƒ†ã‚£</h4><div class="abilities-list" id="slideAbilities"></div></div><div class="connect-condition-area" id="slideConnectConditionArea" style="display:none"><div class="connect-condition-card"><div class="connect-condition-label">ã‚³ãƒã‚¯ãƒˆç™ºå‹•æ¡ä»¶</div><div class="connect-condition-text" id="slideConnectCondition"></div></div></div><div class="special-skills-area" id="slideSpecialSkills" style="display:none"><div class="special-skill-card" id="slideShotSkillCard" style="display:none"><div class="special-skill-type">ã‚·ãƒ§ãƒƒãƒˆã‚¹ã‚­ãƒ«</div><div class="special-skill-name" id="slideShotSkill"></div></div><div class="special-skill-card" id="slideAssistSkillCard" style="display:none"><div class="special-skill-type">ã‚¢ã‚·ã‚¹ãƒˆã‚¹ã‚­ãƒ«</div><div class="special-skill-name" id="slideAssistSkill"></div></div></div></div><div class="slide-right"><div class="character-image-container"><div class="character-image-wrapper"><div class="no-image-placeholder" id="noImagePlaceholder">ç”»åƒæœªè¨­å®š</div><img class="character-image" id="slideImage" style="display:none"></div></div><div class="skills-section"><div class="skill-card"><div class="skill-header"><span class="skill-type">SS</span><span class="skill-turn" id="slideSSTurn">16ã‚¿ãƒ¼ãƒ³</span></div><div class="skill-name" id="slideSSName">ã‚¹ãƒˆãƒ©ã‚¤ã‚¯ã‚·ãƒ§ãƒƒãƒˆå</div><div class="skill-effect" id="slideSSEffect"></div></div><div class="friendship-section"><div class="friendship-card"><div class="friendship-label">å‹æƒ…ã‚³ãƒ³ãƒœ</div><div class="friendship-name" id="slideFriendship">å‹æƒ…ã‚³ãƒ³ãƒœå</div></div><div class="friendship-card"><div class="friendship-label">å‰¯å‹æƒ…ã‚³ãƒ³ãƒœ</div><div class="friendship-name" id="slideSubFriendship">å‰¯å‹æƒ…ã‚³ãƒ³ãƒœå</div></div></div><div class="luck-skill-area" id="slideLuckSkillArea" style="display:none"><div class="luck-skill-card"><div class="luck-skill-label">ãƒ©ãƒƒã‚¯ã‚¹ã‚­ãƒ«</div><div class="luck-skill-name" id="slideLuckSkill"></div></div></div></div></div></div></div></div></div>
        </div>
        <div class="history-panel" id="historyPanel"><div class="history-header"><span class="history-title">ä½œæˆå±¥æ­´</span><button class="btn btn-secondary" id="clearHistoryBtn"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg>å…¨å‰Šé™¤</button></div><div class="history-list" id="historyList"></div></div>
        <div class="help-panel" id="helpPanel"><div class="help-content">
<h2>ğŸ® ä½¿ã„æ–¹</h2>
<h3>1. åŸºæœ¬æƒ…å ±ã‚’å…¥åŠ›</h3>
<ul>
<li><strong>ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å</strong>: ç®¡ç†ç”¨ã®åå‰ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«åã«ä½¿ç”¨ï¼‰</li>
<li><strong>é€²åŒ–å½¢æ…‹</strong>: ç£ç¥åŒ– / ç£ç¥åŒ–æ”¹ / çœŸç£ç¥åŒ– ã‹ã‚‰é¸æŠ</li>
<li><strong>å±æ€§</strong>: ç« / æ°´ / æœ¨ / å…‰ / é—‡ ã‹ã‚‰é¸æŠ</li>
<li><strong>æ’ƒç¨®</strong>: åå°„ / è²«é€š ã‹ã‚‰é¸æŠ</li>
<li><strong>æˆ¦å‹</strong>: ãƒãƒ©ãƒ³ã‚¹å‹ / ãƒ‘ãƒ¯ãƒ¼å‹ / ã‚¹ãƒ”ãƒ¼ãƒ‰å‹ / ç ²æ’ƒå‹ ã‹ã‚‰é¸æŠ</li>
<li><strong>ç¨®æ—</strong>: ä»»æ„ã®ç¨®æ—åã‚’å…¥åŠ›</li>
</ul>
<h3>2. ã‚¢ãƒ“ãƒªãƒ†ã‚£ã‚’å…¥åŠ›</h3>
<ul>
<li>æœ€å¤§8å€‹ã¾ã§å…¥åŠ›å¯èƒ½</li>
<li>å„ã‚¢ãƒ“ãƒªãƒ†ã‚£ã®å·¦ã®ãƒœã‚¿ãƒ³ã§ã€Œã‚¢ãƒ“ã€ï¼ˆé€šå¸¸ï¼‰ã¨ã€Œã‚²ãƒ¼ã‚¸ã€ã‚’åˆ‡ã‚Šæ›¿ãˆ</li>
</ul>
<h3>3. é€²åŒ–å½¢æ…‹åˆ¥ã®å…¥åŠ›</h3>
<h4>ç£ç¥åŒ–æ”¹ã®å ´åˆ</h4>
<ul>
<li><strong>ã‚³ãƒã‚¯ãƒˆã‚¹ã‚­ãƒ«</strong>: æœ€å¤§3å€‹ã¾ã§å…¥åŠ›</li>
<li><strong>ç™ºå‹•æ¡ä»¶</strong>: ã‚³ãƒã‚¯ãƒˆã‚¹ã‚­ãƒ«ã®ç™ºå‹•æ¡ä»¶ã‚’å…¥åŠ›</li>
</ul>
<h4>çœŸç£ç¥åŒ–ã®å ´åˆ</h4>
<ul>
<li><strong>ã‚·ãƒ§ãƒƒãƒˆã‚¹ã‚­ãƒ«</strong>: ã‚·ãƒ§ãƒƒãƒˆã‚¹ã‚­ãƒ«ã®åŠ¹æœã‚’å…¥åŠ›</li>
<li><strong>ã‚¢ã‚·ã‚¹ãƒˆã‚¹ã‚­ãƒ«</strong>: ã‚¢ã‚·ã‚¹ãƒˆã‚¹ã‚­ãƒ«ã®åŠ¹æœã‚’å…¥åŠ›</li>
</ul>
<h3>4. ãƒ©ãƒƒã‚¯ã‚¹ã‚­ãƒ«ã‚’é¸æŠ</h3>
<ul>
<li>ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ« / ã‚¬ã‚¤ãƒ‰ / ã‚·ãƒ¼ãƒ«ãƒ‰ / å‹æƒ…ã‚³ãƒ³ãƒœã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ« ã‹ã‚‰é¸æŠ</li>
</ul>
<h3>5. ã‚¹ãƒˆãƒ©ã‚¤ã‚¯ã‚·ãƒ§ãƒƒãƒˆã‚’å…¥åŠ›</h3>
<ul>
<li><strong>SSåç§°</strong>: ã‚¹ãƒˆãƒ©ã‚¤ã‚¯ã‚·ãƒ§ãƒƒãƒˆã®åå‰</li>
<li><strong>ã‚¿ãƒ¼ãƒ³æ•°</strong>: ç™ºå‹•ã¾ã§ã®ã‚¿ãƒ¼ãƒ³æ•°</li>
<li><strong>SSåŠ¹æœ</strong>: åŠ¹æœã®èª¬æ˜</li>
</ul>
<h3>6. å‹æƒ…ã‚³ãƒ³ãƒœã‚’å…¥åŠ›</h3>
<ul>
<li><strong>å‹æƒ…ã‚³ãƒ³ãƒœ</strong>: ãƒ¡ã‚¤ãƒ³ã®å‹æƒ…ã‚³ãƒ³ãƒœ</li>
<li><strong>å‰¯å‹æƒ…ã‚³ãƒ³ãƒœ</strong>: ã‚µãƒ–ã®å‹æƒ…ã‚³ãƒ³ãƒœ</li>
</ul>
<h3>7. ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”»åƒã‚’è¨­å®š</h3>
<ul>
<li>ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</li>
<li>ã‚µã‚¤ã‚ºãƒ»ä½ç½®ã®èª¿æ•´ãŒå¯èƒ½</li>
</ul>
<h2>ğŸ“¤ å‡ºåŠ›</h2>
<ul>
<li><strong>PNGå‡ºåŠ›</strong>: 1920Ã—1080pxã®ã‚¹ãƒ©ã‚¤ãƒ‰ç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</li>
<li><strong>ä¿å­˜</strong>: ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ï¼ˆæœ€å¤§50ä»¶ï¼‰</li>
</ul>
<h2>ğŸ¨ ãƒ†ãƒ¼ãƒåˆ‡æ›¿</h2>
<p>å³ä¸Šã®æœˆ/å¤ªé™½ã‚¢ã‚¤ã‚³ãƒ³ã§ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰/ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã§ãã¾ã™ã€‚</p>
<h2>ğŸ’¡ Tips</h2>
<ul>
<li>å±æ€§ã‚’é¸æŠã™ã‚‹ã¨ã€ã‚¹ãƒ©ã‚¤ãƒ‰ã®è‰²ãŒè‡ªå‹•ã§å¤‰ã‚ã‚Šã¾ã™</li>
<li>ç”»åƒã¯é€éPNGæ¨å¥¨</li>
<li>ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã•ã‚Œã¾ã™</li>
</ul>
<p class="help-author">ä½œæˆè€…: ã™ã¿ã™</p>
</div></div>
    </main>
</div>
<div class="loading-overlay" id="loadingOverlay"><div class="loading-spinner"></div></div>
<script>
const C={fire:{main:'#E53935',dark:'#B71C1C',name:'ç«'},water:{main:'#1E88E5',dark:'#0D47A1',name:'æ°´'},wood:{main:'#43A047',dark:'#1B5E20',name:'æœ¨'},light:{main:'#FDD835',dark:'#F9A825',name:'å…‰'},dark:{main:'#8E24AA',dark:'#4A148C',name:'é—‡'}};
const $=id=>document.getElementById(id),el={charName:$('charName'),showCharName:$('showCharName'),evolution:$('evolution'),attribute:$('attribute'),shotType:$('shotType'),battleType:$('battleType'),race:$('race'),connect1:$('connect1'),connect2:$('connect2'),connect3:$('connect3'),connectCondition:$('connectCondition'),luckSkill:$('luckSkill'),shotSkill:$('shotSkill'),assistSkill:$('assistSkill'),ssName:$('ssName'),ssTurn:$('ssTurn'),ssEffect:$('ssEffect'),friendship:$('friendship'),subFriendship:$('subFriendship'),imageInput:$('imageInput'),imageUploadArea:$('imageUploadArea'),uploadPlaceholder:$('uploadPlaceholder'),imageControls:$('imageControls'),imgScale:$('imgScale'),imgX:$('imgX'),imgY:$('imgY'),imgScaleVal:$('imgScaleVal'),imgXVal:$('imgXVal'),imgYVal:$('imgYVal'),connectSection:$('connectSection'),specialSkillsSection:$('specialSkillsSection'),slide:$('slide'),slideCharNameArea:$('slideCharNameArea'),slideCharName:$('slideCharName'),slideEvolution:$('slideEvolution'),slideAttribute:$('slideAttribute'),slideShotType:$('slideShotType'),slideBattleType:$('slideBattleType'),slideRace:$('slideRace'),slideAbilities:$('slideAbilities'),slideSpecialSkills:$('slideSpecialSkills'),slideShotSkill:$('slideShotSkill'),slideShotSkillCard:$('slideShotSkillCard'),slideAssistSkill:$('slideAssistSkill'),slideAssistSkillCard:$('slideAssistSkillCard'),slideImage:$('slideImage'),noImagePlaceholder:$('noImagePlaceholder'),slideSSName:$('slideSSName'),slideSSTurn:$('slideSSTurn'),slideSSEffect:$('slideSSEffect'),slideFriendship:$('slideFriendship'),slideSubFriendship:$('slideSubFriendship'),slideLuckSkillArea:$('slideLuckSkillArea'),slideLuckSkill:$('slideLuckSkill'),slideConnectConditionArea:$('slideConnectConditionArea'),slideConnectCondition:$('slideConnectCondition'),exportBtn:$('exportBtn'),saveBtn:$('saveBtn'),loadingOverlay:$('loadingOverlay'),historyPanel:$('historyPanel'),historyList:$('historyList'),editorPanel:$('editorPanel'),previewPanel:$('previewPanel'),helpPanel:$('helpPanel'),clearHistoryBtn:$('clearHistoryBtn'),themeToggle:$('themeToggle'),darkIcon:$('darkIcon'),lightIcon:$('lightIcon')};
let img=null,editId=null,imgSettings={scale:100,x:0,y:0},isDark=true;
function toggleTheme(){isDark=!isDark;document.documentElement.setAttribute('data-theme',isDark?'dark':'light');el.darkIcon.style.display=isDark?'block':'none';el.lightIcon.style.display=isDark?'none':'block';el.slide.classList.toggle('light-mode',!isDark);localStorage.setItem('monstSlideTheme',isDark?'dark':'light')}
el.themeToggle.addEventListener('click',toggleTheme);
(function initTheme(){const saved=localStorage.getItem('monstSlideTheme');if(saved==='light'){isDark=false;document.documentElement.setAttribute('data-theme','light');el.darkIcon.style.display='none';el.lightIcon.style.display='block';el.slide.classList.add('light-mode')}})();
const abTypes=[0,0,0,0,0,0,0,0];
window.toggleAb=idx=>{abTypes[idx]=abTypes[idx]===0?1:0;const btn=document.querySelector(`.ability-toggle[data-idx="${idx}"]`);btn.className=`ability-toggle ${abTypes[idx]===0?'badge-ability':'badge-gauge'}`;btn.textContent=abTypes[idx]===0?'ã‚¢ãƒ“':'ã‚²ãƒ¼ã‚¸';upd()};
window.resetImg=()=>{imgSettings={scale:100,x:0,y:0};el.imgScale.value=100;el.imgX.value=0;el.imgY.value=0;el.imgScaleVal.textContent='100%';el.imgXVal.textContent='0';el.imgYVal.textContent='0';upd()};
['charName','evolution','attribute','shotType','battleType','race','connect1','connect2','connect3','connectCondition','luckSkill','shotSkill','assistSkill','ssName','ssTurn','ssEffect','friendship','subFriendship'].forEach(k=>{if(el[k])el[k].addEventListener('input',upd);if(el[k])el[k].addEventListener('change',upd)});
el.showCharName.addEventListener('change',upd);
for(let i=0;i<8;i++)$('ab'+i).addEventListener('input',upd);
el.imgScale.addEventListener('input',()=>{imgSettings.scale=parseInt(el.imgScale.value);el.imgScaleVal.textContent=imgSettings.scale+'%';upd()});
el.imgX.addEventListener('input',()=>{imgSettings.x=parseInt(el.imgX.value);el.imgXVal.textContent=imgSettings.x;upd()});
el.imgY.addEventListener('input',()=>{imgSettings.y=parseInt(el.imgY.value);el.imgYVal.textContent=imgSettings.y;upd()});
el.evolution.addEventListener('change',()=>{vis();upd()});el.attribute.addEventListener('change',upd);
el.imageUploadArea.addEventListener('click',()=>el.imageInput.click());
el.imageInput.addEventListener('change',()=>{const f=el.imageInput.files[0];if(f){const r=new FileReader();r.onload=e=>{img=e.target.result;el.uploadPlaceholder.innerHTML=`<img src="${img}">`;el.imageUploadArea.classList.add('has-image');el.imageControls.style.display='block';upd()};r.readAsDataURL(f)}});
el.imageUploadArea.addEventListener('dragover',e=>{e.preventDefault();el.imageUploadArea.style.borderColor='var(--fire)'});
el.imageUploadArea.addEventListener('dragleave',()=>el.imageUploadArea.style.borderColor='');
el.imageUploadArea.addEventListener('drop',e=>{e.preventDefault();el.imageUploadArea.style.borderColor='';if(e.dataTransfer.files.length){el.imageInput.files=e.dataTransfer.files;el.imageInput.dispatchEvent(new Event('change'))}});
el.exportBtn.addEventListener('click',exp);el.saveBtn.addEventListener('click',save);el.clearHistoryBtn.addEventListener('click',()=>{if(confirm('ã™ã¹ã¦ã®å±¥æ­´ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')){localStorage.removeItem('monstSlideHistory');hist()}});
document.querySelectorAll('.nav-tab').forEach(t=>t.addEventListener('click',()=>tab(t.dataset.tab)));
function vis(){const e=el.evolution.value;el.connectSection.classList.toggle('hidden',e!=='ç£ç¥åŒ–æ”¹');el.specialSkillsSection.classList.toggle('hidden',e!=='çœŸç£ç¥åŒ–')}
function upd(){const a=el.attribute.value,c=C[a],e=el.evolution.value;el.slide.style.setProperty('--accent-color',c.main);el.slide.style.setProperty('--accent-dark',c.dark);el.slideEvolution.textContent=e;el.slideAttribute.textContent=c.name;
const st=el.shotType.value;el.slideShotType.textContent=st;el.slideShotType.className='info-value'+(st.includes('åå°„')?' shot-reflect':st.includes('è²«é€š')?' shot-penetrate':'');
const bt=el.battleType.value;el.slideBattleType.textContent=(e==='ç£ç¥åŒ–æ”¹'||e==='çœŸç£ç¥åŒ–')?'è¶…'+bt:bt;
el.slideRace.textContent=el.race.value||'âˆ’';
if(el.showCharName.checked&&el.charName.value){el.slideCharNameArea.style.display='block';el.slideCharName.textContent=el.charName.value}else{el.slideCharNameArea.style.display='none'}
const ab=[];for(let i=0;i<8;i++){const v=$('ab'+i).value;if(v)ab.push({t:abTypes[i]===0?'ability':'gauge',n:v})}if(e==='ç£ç¥åŒ–æ”¹')[el.connect1,el.connect2,el.connect3].forEach(x=>{if(x.value)ab.push({t:'connect',n:x.value})});
el.slideAbilities.innerHTML=ab.map(x=>`<span class="ability-tag type-${x.t}">${x.n}</span>`).join('');
if(e==='çœŸç£ç¥åŒ–'){el.slideSpecialSkills.style.display='block';el.slideShotSkillCard.style.display=el.shotSkill.value?'block':'none';el.slideShotSkill.textContent=el.shotSkill.value;el.slideAssistSkillCard.style.display=el.assistSkill.value?'block':'none';el.slideAssistSkill.textContent=el.assistSkill.value}else el.slideSpecialSkills.style.display='none';
if(img){el.slideImage.src=img;el.slideImage.style.display='block';el.slideImage.style.transform=`translate(${imgSettings.x}px,${imgSettings.y}px) scale(${imgSettings.scale/100})`;el.noImagePlaceholder.style.display='none'}else{el.slideImage.style.display='none';el.noImagePlaceholder.style.display='flex'}
el.slideSSName.textContent=el.ssName.value||'';el.slideSSName.style.display=el.ssName.value?'block':'none';el.slideSSTurn.textContent=el.ssTurn.value?el.ssTurn.value+'ã‚¿ãƒ¼ãƒ³':'';el.slideSSEffect.textContent=el.ssEffect.value||'';el.slideFriendship.textContent=el.friendship.value||'å‹æƒ…ã‚³ãƒ³ãƒœå';el.slideSubFriendship.textContent=el.subFriendship.value||'å‰¯å‹æƒ…ã‚³ãƒ³ãƒœå';
const luckVal=el.luckSkill.value;if(luckVal){el.slideLuckSkillArea.style.display='block';el.slideLuckSkill.textContent=luckVal}else{el.slideLuckSkillArea.style.display='none'}
const condVal=el.connectCondition.value;if(e==='ç£ç¥åŒ–æ”¹'&&condVal){el.slideConnectConditionArea.style.display='block';el.slideConnectCondition.textContent=condVal}else{el.slideConnectConditionArea.style.display='none'}}
async function exp(){load(1);try{const ot=el.slide.style.transform;el.slide.style.transform='none';const bgColor=isDark?'#0a0a12':'#f8f8fc';const cv=await html2canvas(el.slide,{width:1920,height:1080,scale:1,useCORS:true,allowTaint:true,backgroundColor:bgColor,logging:false});el.slide.style.transform=ot;const a=document.createElement('a');a.download=`${el.charName.value||'character'}_${el.evolution.value}.png`;a.href=cv.toDataURL('image/png');document.body.appendChild(a);a.click();document.body.removeChild(a)}catch(e){console.error(e);alert('ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ: '+e.message)}load(0)}
function getData(){const abs=[];for(let i=0;i<8;i++)abs.push({val:$('ab'+i).value,type:abTypes[i]});return{charName:el.charName.value,showCharName:el.showCharName.checked,evolution:el.evolution.value,attribute:el.attribute.value,shotType:el.shotType.value,battleType:el.battleType.value,race:el.race.value,abilities:abs,connect1:el.connect1.value,connect2:el.connect2.value,connect3:el.connect3.value,connectCondition:el.connectCondition.value,luckSkill:el.luckSkill.value,shotSkill:el.shotSkill.value,assistSkill:el.assistSkill.value,ssName:el.ssName.value,ssTurn:el.ssTurn.value,ssEffect:el.ssEffect.value,friendship:el.friendship.value,subFriendship:el.subFriendship.value,imageData:img,imgSettings:{...imgSettings}}}
function setData(d){Object.keys(d).forEach(k=>{if(k==='imageData'){img=d[k];if(img){el.uploadPlaceholder.innerHTML=`<img src="${img}">`;el.imageUploadArea.classList.add('has-image');el.imageControls.style.display='block'}}else if(k==='imgSettings'&&d[k]){imgSettings={...d[k]};el.imgScale.value=imgSettings.scale;el.imgX.value=imgSettings.x;el.imgY.value=imgSettings.y;el.imgScaleVal.textContent=imgSettings.scale+'%';el.imgXVal.textContent=imgSettings.x;el.imgYVal.textContent=imgSettings.y}else if(k==='showCharName'){el.showCharName.checked=d[k]||false}else if(k==='abilities'&&d[k]){d[k].forEach((ab,i)=>{$('ab'+i).value=ab.val||'';abTypes[i]=ab.type||0;const btn=document.querySelector(`.ability-toggle[data-idx="${i}"]`);btn.className=`ability-toggle ${abTypes[i]===0?'badge-ability':'badge-gauge'}`;btn.textContent=abTypes[i]===0?'ã‚¢ãƒ“':'ã‚²ãƒ¼ã‚¸'})}else if(el[k])el[k].value=d[k]||''});vis();upd()}
async function save(){const d=getData();if(!d.charName){alert('ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');return}load(1);try{const ot=el.slide.style.transform;el.slide.style.transform='none';const bgColor=isDark?'#0a0a12':'#f8f8fc';const cv=await html2canvas(el.slide,{width:1920,height:1080,scale:.2,useCORS:true,allowTaint:true,backgroundColor:bgColor,logging:false});el.slide.style.transform=ot;const th=cv.toDataURL('image/jpeg',.7);let h=JSON.parse(localStorage.getItem('monstSlideHistory')||'[]');const en={id:editId||Date.now().toString(),data:d,thumbnail:th,createdAt:editId?h.find(x=>x.id===editId)?.createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if(editId){const i=h.findIndex(x=>x.id===editId);if(i!==-1)h[i]=en;editId=null}else h.unshift(en);h=h.slice(0,50);localStorage.setItem('monstSlideHistory',JSON.stringify(h));hist();alert('ä¿å­˜ã—ã¾ã—ãŸ')}catch(e){console.error(e);alert('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: '+e.message)}load(0)}
function hist(){const h=JSON.parse(localStorage.getItem('monstSlideHistory')||'[]');if(!h.length){el.historyList.innerHTML='<div class="empty-history">ä¿å­˜ã•ã‚ŒãŸã‚¹ãƒ©ã‚¤ãƒ‰ã¯ã‚ã‚Šã¾ã›ã‚“</div>';return}el.historyList.innerHTML=h.map(i=>`<div class="history-item"><img class="history-thumbnail" src="${i.thumbnail}"><div class="history-info"><div class="history-name">${i.data.charName}</div><div class="history-meta"><span>${i.data.evolution}</span><span>${new Date(i.updatedAt).toLocaleDateString('ja-JP')}</span></div></div><div class="history-actions"><button class="history-btn history-btn-edit" onclick="lf('${i.id}')">ç·¨é›†</button><button class="history-btn history-btn-delete" onclick="df('${i.id}')">å‰Šé™¤</button></div></div>`).join('')}
window.lf=id=>{const h=JSON.parse(localStorage.getItem('monstSlideHistory')||'[]'),i=h.find(x=>x.id===id);if(i){editId=id;setData(i.data);tab('editor')}};
window.df=id=>{if(!confirm('ã“ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ'))return;let h=JSON.parse(localStorage.getItem('monstSlideHistory')||'[]');h=h.filter(x=>x.id!==id);localStorage.setItem('monstSlideHistory',JSON.stringify(h));hist()};
function tab(t){document.querySelectorAll('.nav-tab').forEach(x=>x.classList.remove('active'));document.querySelector(`[data-tab="${t}"]`).classList.add('active');el.editorPanel.style.display=t==='editor'?'block':'none';el.previewPanel.style.display=t==='editor'?'flex':'none';el.historyPanel.classList.toggle('active',t==='history');el.helpPanel.classList.toggle('active',t==='help')}
function load(s){el.loadingOverlay.classList.toggle('active',s)}
vis();upd();hist();
</script>
</body>
</html>
